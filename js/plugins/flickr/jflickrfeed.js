(function(a){a.fn.jflickrfeed=function(e,b){e=a.extend(true,{flickrbase:"http://api.flickr.com/services/feeds/",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:true,useTemplate:true,itemTemplate:"",itemCallback:function(){}},e);var f=e.flickrbase+e.feedapi+"?";var c=true;for(var d in e.qstrings){if(!c){f+="&"}f+=d+"="+e.qstrings[d];c=false}return a(this).each(function(){var g=a(this);var h=this;a.getJSON(f,function(i){a.each(i.items,function(j,l){if(j<e.limit){if(e.cleanDescription){var n=/<p>(.*?)<\/p>/g;var k=l.description;if(n.test(k)){l.description=k.match(n)[2];if(l.description!=undefined){l.description=l.description.replace("<p>","").replace("</p>","")}}}l.image_s=l.media.m.replace("_m","_s");l.image_t=l.media.m.replace("_m","_t");l.image_m=l.media.m.replace("_m","_m");l.image=l.media.m.replace("_m","");l.image_b=l.media.m.replace("_m","_b");l.image_q=l.media.m.replace("_m","_q");delete l.media;if(e.useTemplate){var p=e.itemTemplate;for(var m in l){var o=new RegExp("{{"+m+"}}","g");p=p.replace(o,l[m])}g.append(p)}e.itemCallback.call(h,l)}});if(a.isFunction(b)){b.call(h,i)}})})}})(jQuery);