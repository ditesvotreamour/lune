(function(a,l,k){var b=a.event,c,j;c=b.special.debouncedresize={setup:function(){a(this).on("resize",c.handler)},teardown:function(){a(this).off("resize",c.handler)},handler:function(p,q){var n=this,m=arguments,o=function(){p.type="debouncedresize";b.dispatch.apply(n,m)};if(j){clearTimeout(j)}q?o():j=setTimeout(o,c.threshold)},threshold:100};Array.prototype.shuffle=function(){var m=this.length,n,o;while(m--){n=Math.floor(Math.random()*m);o=this[m];this[m]=this[n];this[n]=o}return this};function e(){var n=["webkit","moz","ms","o"];if("hidden" in document){return"hidden"}for(var m=0;m<n.length;m++){if((n[m]+"Hidden") in document){return n[m]+"Hidden"}}return null}function g(){var m=e();if(!m){return false}return document[m]}function f(m){return Object.keys(m).length===0}var d=a(l),i=l.Modernizr;a.GridRotator=function(n,m){this.$el=a(m);if(i.backgroundsize){var o=this;this.$el.addClass("ri-grid-loading");this._init(n)}};a.GridRotator.defaults={rows:4,columns:10,imageRatio:1,w1024:{rows:3,columns:8},w768:{rows:3,columns:7},w480:{rows:3,columns:5},w320:{rows:2,columns:4},w240:{rows:2,columns:3},step:"random",maxStep:3,preventClick:true,animType:"random",animSpeed:800,animEasingOut:"linear",animEasingIn:"linear",interval:3000,slideshow:true,onhover:false,nochange:[]};a.GridRotator.prototype={_init:function(m){this.options=a.extend(true,{},a.GridRotator.defaults,m);this._config()},_config:function(){var p=this,q={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.supportTransitions=i.csstransitions;this.supportTransforms3D=i.csstransforms3d;this.transEndEventName=q[i.prefixed("transition")]+".gridrotator";this.animTypes=this.supportTransforms3D?["fadeInOut","slideLeft","slideRight","slideTop","slideBottom","rotateLeft","rotateRight","rotateTop","rotateBottom","scale","rotate3d","rotateLeftScale","rotateRightScale","rotateTopScale","rotateBottomScale"]:["fadeInOut","slideLeft","slideRight","slideTop","slideBottom"];this.animType=this.options.animType;if(this.animType!=="random"&&!this.supportTransforms3D&&a.inArray(this.animType,this.animTypes)===-1&&this.animType!=="showHide"){this.animType="fadeInOut"}this.animTypesTotal=this.animTypes.length;this.$list=this.$el.children("ul");var o=0,m=this.$list.find("img"),n=m.length;m.each(function(){var r=a(this),s=r.attr("src");a("<img/>").load(function(){++o;r.parent().css("background-image","url("+s+")");if(o===n){m.remove();p.$el.removeClass("ri-grid-loading");p.$items=p.$list.children("li");p.$itemsCache=p.$items.clone();p.itemsTotal=p.$items.length;p.outItems=[];p._layout(function(){p._initEvents()});p._start()}}).attr("src",s)})},_layout:function(p){var w=this;this._setGridDim();this.$list.empty();this.$items=this.$itemsCache.clone().appendTo(this.$list);var o=this.$items.filter(":gt("+(this.showTotal-1)+")"),n=o.children("a");this.outItems.length=0;n.each(function(x){w.outItems.push(a(this))});o.remove();var q=(document.defaultView)?parseInt(document.defaultView.getComputedStyle(this.$el.get(0),null).width):this.$el.width(),u=Math.floor(q/this.columns),r=q-(this.columns*Math.floor(u));for(var s=0;s<this.rows;++s){for(var v=0;v<this.columns;++v){var t=this.columns*s+v,m=this.$items.eq(t);m.css({width:v<Math.floor(r)?u+1:u,height:u/this.options.imageRatio});if(a.inArray(t,this.options.nochange)!==-1){m.addClass("ri-nochange").data("nochange",true)}}}if(this.options.preventClick){this.$items.children().css("cursor","default").on("click.gridrotator",false)}if(p){p.call()}},_setGridDim:function(){var m=this.$el.width();switch(true){case (m<240):this.rows=this.options.w240.rows;this.columns=this.options.w240.columns;break;case (m<320):this.rows=this.options.w320.rows;this.columns=this.options.w320.columns;break;case (m<480):this.rows=this.options.w480.rows;this.columns=this.options.w480.columns;break;case (m<768):this.rows=this.options.w768.rows;this.columns=this.options.w768.columns;break;case (m<1024):this.rows=this.options.w1024.rows;this.columns=this.options.w1024.columns;break;default:this.rows=this.options.rows;this.columns=this.options.columns;break}this.showTotal=this.rows*this.columns},_initEvents:function(){var n=this;d.on("debouncedresize.gridrotator",function(){n._layout()});var o=e();if(o){var m=o.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(m,function(){n._visChange()})}if(!i.touch&&this.options.onhover){n.$items.on("mouseenter.gridrotator",function(){var p=a(this);if(!p.data("active")&&!p.data("hovered")&&!p.data("nochange")){p.data("hovered",true);n._replace(p)}}).on("mouseleave.gridrotator",function(){a(this).data("hovered",false)})}},_visChange:function(){g()?clearTimeout(this.playtimeout):this._start()},_start:function(){if(this.showTotal<this.itemsTotal&&this.options.slideshow){this._showNext()}},_getAnimType:function(){return this.animType==="random"?this.animTypes[Math.floor(Math.random()*this.animTypesTotal)]:this.animType},_getAnimProperties:function(m){var s={},t={},p={},q={},n=this._getAnimType(),r,o=0;switch(n){case"showHide":r=0;q.opacity=0;break;case"fadeInOut":q.opacity=0;break;case"slideLeft":s.left=m.width();p.left=0;q.left=-m.width();break;case"slideRight":s.left=-m.width();p.left=0;q.left=m.width();break;case"slideTop":s.top=m.height();p.top=0;q.top=-m.height();break;case"slideBottom":s.top=-m.height();p.top=0;q.top=m.height();break;case"rotateLeft":r=this.options.animSpeed/2;s.transform="rotateY(90deg)";p.transform="rotateY(0deg)";o=r;q.transform="rotateY(-90deg)";break;case"rotateRight":r=this.options.animSpeed/2;s.transform="rotateY(-90deg)";p.transform="rotateY(0deg)";o=r;q.transform="rotateY(90deg)";break;case"rotateTop":r=this.options.animSpeed/2;s.transform="rotateX(90deg)";p.transform="rotateX(0deg)";o=r;q.transform="rotateX(-90deg)";break;case"rotateBottom":r=this.options.animSpeed/2;s.transform="rotateX(-90deg)";p.transform="rotateX(0deg)";o=r;q.transform="rotateX(90deg)";break;case"scale":r=this.options.animSpeed/2;s.transform="scale(0)";t.transform="scale(1)";p.transform="scale(1)";o=r;q.transform="scale(0)";break;case"rotateLeftScale":t.transform="scale(1)";r=this.options.animSpeed/2;s.transform="scale(0.3) rotateY(90deg)";p.transform="scale(1) rotateY(0deg)";o=r;q.transform="scale(0.3) rotateY(-90deg)";break;case"rotateRightScale":t.transform="scale(1)";r=this.options.animSpeed/2;s.transform="scale(0.3) rotateY(-90deg)";p.transform="scale(1) rotateY(0deg)";o=r;q.transform="scale(0.3) rotateY(90deg)";break;case"rotateTopScale":t.transform="scale(1)";r=this.options.animSpeed/2;s.transform="scale(0.3) rotateX(90deg)";p.transform="scale(1) rotateX(0deg)";o=r;q.transform="scale(0.3) rotateX(-90deg)";break;case"rotateBottomScale":t.transform="scale(1)";r=this.options.animSpeed/2;s.transform="scale(0.3) rotateX(-90deg)";p.transform="scale(1) rotateX(0deg)";o=r;q.transform="scale(0.3) rotateX(90deg)";break;case"rotate3d":r=this.options.animSpeed/2;s.transform="rotate3d( 1, 1, 0, 90deg )";p.transform="rotate3d( 1, 1, 0, 0deg )";o=r;q.transform="rotate3d( 1, 1, 0, -90deg )";break}return{startInProp:s,startOutProp:t,endInProp:p,endOutProp:q,delay:o,animSpeed:r!=k?r:this.options.animSpeed}},_showNext:function(n){var m=this;clearTimeout(this.playtimeout);this.playtimeout=setTimeout(function(){var u=m.options.step,q=m.options.maxStep,r=1;if(q>m.showTotal){q=m.showTotal}var s=u==="random"?Math.floor(Math.random()*q+r):Math.min(Math.abs(u),q),t=m._getRandom(s,m.showTotal);for(var p=0;p<s;++p){var o=m.$items.eq(t[p]);if(o.data("active")||o.data("nochange")){m._showNext(1);return false}m._replace(o)}m._showNext()},n||Math.max(Math.abs(this.options.interval),300))},_replace:function(n){n.data("active",true);var r=this,o=n.children("a:last"),q={width:o.width(),height:o.height()};n.data("active",true);var m=this.outItems.shift();this.outItems.push(o.clone().css("transition","none"));m.css(q).prependTo(n);var p=this._getAnimProperties(o);m.css(p.startInProp);o.css(p.startOutProp);this._setTransition(m,"all",p.animSpeed,p.delay,this.options.animEasingIn);this._setTransition(o,"all",p.animSpeed,0,this.options.animEasingOut);this._applyTransition(m,p.endInProp,p.animSpeed,function(){var s=a(this),u=p.animSpeed===r.options.animSpeed&&f(p.endInProp)?p.animSpeed:0;setTimeout(function(){if(r.supportTransitions){s.off(r.transEndEventName)}s.next().remove();s.parent().data("active",false)},u)},p.animSpeed===0||f(p.endInProp));this._applyTransition(o,p.endOutProp,p.animSpeed)},_getRandom:function(m,o){var p=[];for(var n=0;n<o;++n){p.push(n)}return p.shuffle().slice(0,m)},_setTransition:function(o,p,q,m,n){setTimeout(function(){o.css("transition",p+" "+q+"ms "+m+"ms "+n)},25)},_applyTransition:function(m,r,q,n,o){var p=this;setTimeout(function(){a.fn.applyStyle=p.supportTransitions?a.fn.css:a.fn.animate;if(n&&p.supportTransitions){m.on(p.transEndEventName,n);if(o){n.call(m)}}n=n||function(){return false};m.stop().applyStyle(r,a.extend(true,[],{duration:q+"ms",complete:n}))},25)}};var h=function(m){if(l.console){l.console.error(m)}};a.fn.gridrotator=function(o){var n=a.data(this,"gridrotator");if(typeof o==="string"){var m=Array.prototype.slice.call(arguments,1);this.each(function(){if(!n){h("cannot call methods on gridrotator prior to initialization; attempted to call method '"+o+"'");return}if(!a.isFunction(n[o])||o.charAt(0)==="_"){h("no such method '"+o+"' for gridrotator instance");return}n[o].apply(n,m)})}else{this.each(function(){if(n){n._init()}else{n=a.data(this,"gridrotator",new a.GridRotator(o,this))}})}return n}})(jQuery,window);